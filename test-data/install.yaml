# Note: This is a general-purpose configuration file that contains information not only for this app.
#
# This file is considered to be used to configure the tenant firewall!
#
###########################################
# root@firewall:/etc/metal# date
# Thu May 16 13:48:11 CEST 2019
# root@firewall:/etc/metal# cat install.yaml
# hostname: firewall
# ipaddress: 10.0.12.1
# asn: "4200003073"
# networks:
#   - asn: 4200003073
#     destinationprefixes: []
#     ips:
#       - 10.0.12.1
#     nat: false
#     networkid: bc830818-2df1-4904-8c40-4322296d393d
#     prefixes:
#       - 10.0.12.0/22
#     primary: true
#     underlay: false
#     vrf: 3981
#   - asn: 4200003073
#     destinationprefixes:
#       - 0.0.0.0/0
#     ips:
#       - 185.24.0.1
#     nat: false
#     networkid: internet-vagrant-lab
#     prefixes:
#       - 185.24.0.0/22
#       - 185.27.0.0/22
#     primary: false
#     underlay: false
#     vrf: 104009
#   - asn: 4200003073
#     destinationprefixes: []
#     ips:
#       - 10.1.0.1
#     nat: false
#     networkid: underlay-vagrant-lab
#     prefixes:
#       - 10.0.12.0/22
#     primary: false
#     underlay: true
#     vrf: 0
# machineuuid: e0ab02d2-27cd-5a5e-8efc-080ba80cf258
# sshpublickey: ""
# password: KAWT5DugqSPAezMl
# devmode: false
# console: ttyS0,115200n8
###########################################
---
# Applies to hostname of the firewall.
hostname: firewall
# [IGNORED]
ipaddress: 10.0.12.1
# [IGNORED]
asn: "4200003073"
networks:
  # === Tenant Network (primary=true)
    # [IGNORED]
  - asn: 4200003073
    # [IGNORED in case of primary network]
    destinationprefixes: []
    # Used to consider the set of prefixes that originate the given IP's to establish route leak in external
    # network VRF's for return traffic. Applied to the SVI (as /32)
    ips:
      - 10.0.12.1
    # [IGNORED in case of primary network]
    nat: false
    # [IGNORED in case of primary network]
    networkid: bc830818-2df1-4904-8c40-4322296d393d
    # Prefixes that originate the given IP's are considered for static route leak to route return traffic to the tenant.
    prefixes:
      - 10.0.12.0/22
    primary: true
    # [IGNORED in case of primary network]
    underlay: false
    # Defines the tenant VRF id.
    vrf: 3981
  # === External infrastructure networks to route to
    # [IGNORED]
  - asn: 4200003073
    # Considered to establish static route leak to reach out from tenant VRF into the external networks.
    destinationprefixes:
      - 0.0.0.0/0
    # Applied to the SVI (as /32)
    ips:
      - 185.24.0.1
    # In case nat equals true a post-up hook is added to the SVI that enables MASQUERADING.
    nat: true
    # [IGNORED]
    networkid: internet-vagrant-lab
    # Slack Channel: "metal-lab", 21. Mai https://kube-native.slack.com/archives/CHEK1QFCH/p1558453368001200
    # Markus [5:42 PM]
    #@Thomas @Tobias NAT@firewall: IP muss ans SVI und in der NAT-Regel muss das VRF Interface angegeben werden mit SNAT und der Adresse des SVIs:
    #```bash
    #iptables -t nat -A POSTROUTING -s 10.0.208.0/24 -o vrfInternet -j SNAT --to-source 185.1.2.3
    ## FÃ¼r Logging
    #iptables -t nat -A POSTROUTING -j LOG --log-level 6```
    prefixes:
      - 185.24.0.0/22
      - 185.27.0.0/22
    primary: false
    underlay: false
    # VRF id considered to define EVPN interfaces.
    vrf: 104009
  # === Firewall Underlay Network (firewall_underlay=true)
    # Considered to define the BGP ASN.
  - asn: 4200003073
    # Considered to establish static route leak to reach out from tenant VRF into the external networks.
    destinationprefixes: []
    # Applied to local loopback as /32.
    ips:
      - 10.1.0.1
    # In case nat equals true a post-up hook is added to the interface that enables MASQUERADING.
    nat: false
    # [UNUSED]
    networkid: underlay-vagrant-lab
    # [IGNORED in case of UNDERLAY]
    prefixes:
      - 10.0.12.0/22
    primary: false
    underlay: true
    # [IGNORED] Underlay runs in default VRF.
    vrf: 0
# [IGNORED]
machineuuid: e0ab02d2-27cd-5a5e-8efc-080ba80cf258
# [IGNORED]
sshpublickey: ""
# [IGNORED]
password: KAWT5DugqSPAezMl
# [IGNORED]
devmode: false
# [IGNORED]
console: ttyS1,115200n8


